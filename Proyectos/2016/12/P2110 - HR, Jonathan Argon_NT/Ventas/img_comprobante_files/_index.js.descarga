var DV=DV||{};$(function(){window.setTimeout(function(){if(!DV.documentReady){$(".b-page__loading").show()}},1000);DV.Download=function(q){var r={sk:DV.sk,uid:DV.uid,auth:DV.auth,name:DV.name,"archive-path":q};if(DV.fileid){r.id=DV.fileid}else{r.url=DV.url}$.ajax({url:"./download.xml",type:"post",async:false,data:r,dataType:"json",success:function(s){if(s.status=="ok"){window.open(s.url);return}DV.Count("Ошибка","Скачивание",s.error);if(s.error=="auth"){DV.Auth(function(){$(".js-download").click()})}else{j(o.err400)}},error:function(s,u,t){t=t||u;DV.Count("Ошибка","Скачивание","jq "+t);j(o.err400)}})};$(".js-print").click(function(){DV.Craw("Print",DV.browser,DOC[2])});$(".js-download").click(function(){DV.Cact("download");DV.Download()});$(document).on("click",".js-downloads-folder-link",function(){if(this.href){DV.Cact("link_to_downloads","save")}});DV.SaveToDisk=function(r,u){var t={sk:DV.sk,uid:DV.uid,url:DV.url,name:r,"archive-path":u};var v={sk:DV.sk,uid:DV.uid,oid:null};var z;var q=$.Deferred();function x(B){DV.showPopup("save-to-disk-success",function(D){if(B){var C=B.split("/").filter(Boolean).pop();D.find(".js-downloads-folder-link").attr({href:B,target:"_blank"});D.find(".js-downloads-folder-name").text(C)}else{D.find(".js-downloads-folder-link").attr("href",null)}});q.resolve()}function w(C){var B=C.status||"error";var D="save-to-disk-"+B;if(!o[D]){D="save-to-disk-error"}j(D);q.reject(B)}function s(B){if(B.downloads){z=B.downloads}switch(B.status){case"wait":if(B.oid){v.oid=B.oid;setTimeout(y,100)}else{setTimeout(y,1000)}break;case"success":x(z);break;case"error":default:w(B)}}function A(){w({status:"error"})}function y(){$.ajax({url:"./operation-status.xml",type:"post",data:v,dataType:"json"}).then(s,A)}$.ajax({url:"./save-to-disk.xml",type:"post",data:t,dataType:"json"}).then(s,A);return q.promise()};$(".js-to-disk").click(function(){DV.Cact("save");if(this.href){DV.Count(DOC[1],"Save","noauth");return}DV.SaveToDisk($(this).data("name")).done(function(){DV.Count(DOC[1],"Save","save-to-disk-success")}).fail(function(q){DV.Count(DOC[1],"Save","save-to-disk-"+q)})}).each(function(){DV.Cact("save-show")});DV.q=function(s){s=s||{};var v=document.location.search.slice(1).split("&");res=[];for(var u=0;u<v.length;u++){if(v[u].match(/^[cw]=/)){continue}var t=v[u].match(/^([^=]+)=(.+)$/);if(!t){continue}var r=t[1];if(s[r]){res.push(r+"="+encodeURIComponent(s[r]));delete s[r]}else{res.push(v[u])}}for(var r in s){if(s[r]){res.push(r+"="+encodeURIComponent(s[r]))}}return res.join("&")};$(".js-error-reload").click(function(){document.location.replace("./?"+DV.q())});var e=$(".b-popup-holder");var a=e.find(".b-popup");var b=a.find(".b-popup__header");var g=a.find(".b-popup__body");var n=e.find(".b-mail-domik");var o={};e.find(".js-popup-data").each(function(){var q=$(this);o[this.id]={header:q.data("title"),body:q.contents()}});e.children().not(".b-paranja").addClass("g-hidden");var i=function(){g.children().detach();b.empty();g.empty()};$(document).on("keydown.popup",function(q){if(q.keyCode!==27){return}if(q.shiftKey||q.ctrlKey||q.altKey||q.metaKey){return}if($(q.target).is("input,button,textarea")){return}l()});var m=null;var l=function(q){if(m){window.clearTimeout(m);m=null}if(q){m=window.setTimeout(l,q);return}e.add(a).add(n).addClass("g-hidden");i()};var j=DV.showPopup=function(r,q){if(typeof r=="string"){r=o[r]}i();b.text(r.header);g.append(r.body);if(q){q(g)}e.add(a).removeClass("g-hidden")};i();e.on("click",".js-popup__close",l);var c=DV.socialHost?null:[];var f=null;var k=null;var d=null;DV.Auth=function(q){d=q;if(c){p();return}$.ajax({url:DV.socialHost+"/providers.jsonp?callback=?",dataType:"json",timeout:2000,success:function(v){if($.isArray(v)){c=v}var r=n.find(".b-mail-domik__social").removeClass("g-hidden");var w="";for(var u=0;u<c.length;u++){var x=c[u];if(!x.enabled){continue}w+='<a class="b-mail-domik__social-link" data-provider="'+x.code+'" title="'+x.display_name+'"><i class="b-mail-domik__social-icon b-mail-domik__social-icon_provider_'+x.code+'"></i></a>'}r.append(w);var t=document.location;f=new h.block["i-social"]({retpath:t.protocol+"//"+t.host+"/i-social__closer.html"});n.on("click",".b-mail-domik__social-link",function(s){f.start(function(){DV.AuthResult({status:"ok"})},function(){DV.AuthResult()},{provider:$(this).data("provider")});return false})},complete:p})};DV.AuthResult=function(v){v=v||{status:"internal-exception",msg:"internal-exception"};var t=v.status;if(t=="ok"){l();if(d){d()}d=null;return}var w=n.find(".b-mail-domik__error");if(v.msg){w.text(v.msg).removeClass("g-hidden")}else{w.addClass("g-hidden")}if(t=="other"){return}if(t=="internal-exception"){v={status:t}}if(t!="captcha-required"){n.find("input[name=password]").val("")}switch(t){case"login-empty":case"account-not-found":n.find("input[name=login]").focus();break;case"captcha-required":break;default:n.find("input[name=password]").focus()}var r=n.find("input[name=idkey]");if(v.idkey){r.val(v.idkey).removeAttr("disabled")}else{r.attr("disabled","")}var q=n.find(".b-mail-domik__captcha");var u=n.find("input[name=captcha_answer]");if(v.captcha_url){u.removeAttr("disabled").val("");q.removeClass("g-hidden").find("img").attr("src",v.captcha_url);if(t=="captcha-required"){u.focus()}}else{u.attr("disabled","");q.addClass("g-hidden")}};var p=function(){e.add(n).removeClass("g-hidden");n[0].reset();n[0].login.focus();n.find("input[name=idkey]").attr("disabled","");if(!k){k=$('<iframe class="g-invisible" name="auth_frame"></iframe>').appendTo(e);n.attr("target","auth_frame");var q=document.location;q=q.protocol+"//"+q.host+q.pathname+"login-status.xml";$('<input type="hidden" name="retpath"/>').appendTo(n).val(q)}};n.on("click","button[type=reset]",l);n.on("click",".js-captcha-cant-read",function(){var q=n.find(".b-captcha__image");var r=q.attr("src");r=r.replace(/(&cantread=1.+|)$/,"&cantread=1&ncrnd="+(Math.random()+"00000").slice(2,7));q.attr("src",r)});$(".js-password").on("submit",function(q){q.preventDefault();var r=this.password;if(!r.value){r.focus();return false}l();var s=$(this).serializeArray();s.push({name:"json",value:"1"});s=$.param(s);var t=$(this).data();$(this).removeData();$.ajax($.extend({url:this.action,type:"post",data:s,dataType:"json",success:function(u){document.location.replace("./?"+DV.q())},error:function(u,w,v){v=v||w;DV.Count("Ошибка","Пароль","jq "+v);j(o.err400)}},t))}).find("input:password").eq(0).focus();DV.Pass=function(r,q){var s=o["password-popup"];s._t=s._t||s.header;s.header=s._t.replace("%1",DV.titles[r]);s.body.find("[name=archive-path]").val(r);s.body.filter("form").removeData().data({async:false,success:function(t){if(t.status!=="ok"){return}DV.Download(q)}})[0].reset();j(s)};$(".b-pager:first").each(function(){var r="ctrlKey",s=false,v=$(this);var t=navigator.userAgent.match(/mac os x (\d+)[._](\d+)/i);if(t){var u=parseInt(t.pop(),10),q=parseInt(t.pop(),10);if(q>10||(q===10&&u>6)){r="altKey"}s=true}$(document).on("keydown",function(x){if(!x[r]){return}if(s&&(x.ctrlKey&&(x.metaKey||x.altKey))){return}if(!x.ctrlKey&&!x.altKey||$(x.target).is("input, textarea")||(x.ctrlKey&&x.shiftKey)){return}var w=v.find(".b-pager__"+(x.keyCode===37?"prev":x.keyCode===39?"next":"")).attr("href");if(w){document.location=w}})});(function(C){if(!C){return}var w=$(document);var v=$(".b-page__body");var s=$(".b-page__region");var A=$(".b-page__glass");var D;$.ajax({url:"./words.xml",type:"post",data:{id:DV.fileid,sk:DV.sk,uid:DV.uid,width:DV.Page.width,page:DV.Page.page},dataType:"json",success:function(E){if(!E.length){return}D=C.lines=E;B()}});function B(){var H=$(".b-page__selection-holder");for(var G=0,E=D[0];G<D.length;E=D[++G]){E.w=E.d.slice(2);E.d=[E.d[0],E.d[E.d.length-1],E.d[1],E.d[2]];E.css={top:E.d[0],width:E.d[1]-E.d[3],height:E.d[2]-E.d[0],left:E.d[3]};for(var F=0;F<E.t.length;F++){E.t[F]=E.t[F].replace(/[<>&]/g,function(I){return{"<":"&lt;",">":"&gt;","&":"&amp;"}[I]})}E.s=E.t.join(" ");E.div=$('<div class="b-page__selection"/>').css(E.css).appendTo(H)}$(".b-page__glass").addClass("b-page__glass_text");w.on("mousedown",u).on("keyup",t)}function u(E){if(E.which!==1){return}if(E.altKey||E.ctrlKey||E.shiftKey||E.metaKey){return}r();if(!$(E.target).closest(".b-page").length){return}E.preventDefault();var G=v.offset();var F={c:0,x:Math.max(E.pageX-G.left,0),y:Math.max(E.pageY-G.top,0)};w.on("mousemove.sel mouseup.sel",F,x).on("mouseup.sel",F,z)}function x(E){var K=E.data;var H=K.x,J=K.y;var L=$.extend({w:v.width(),h:v.height()},v.offset());var F=Math.max(E.pageX-L.left,0);var I=Math.max(E.pageY-L.top,0);var G={left:Math.min(H,F),top:Math.min(J,I),display:"block"};G.width=Math.min(Math.abs(F-H),L.w-G.left)-2;G.height=Math.min(Math.abs(I-J),L.h-G.top)-2;s.css(G);K.t=q(G);K.c++}function z(E){var F=E.data;s.css({width:0,height:0,display:""});w.off(".sel");if(F.c<2){r()}else{y(F.t)}}function t(E){try{var G=window.getSelection();if(G.rangeCount!=1){r();return}var H=G.getRangeAt(0);var F=A[0];if((H.startContainer!==H.endContainer)||(H.startContainer!==F)||(H.startOffset!==0)||(H.endOffset!==1)){r();return}}catch(I){var G=document.selection.createRange();var H=document.body.createTextRange();H.moveToElementText(A[0]);if((G.compareEndPoints("StartToStart",H)!==0)||(G.compareEndPoints("EndToEnd",H)!==0)){r();return}}}function y(H){A.html(H);if(H){try{var E=window.getSelection();if(E.rangeCount>0){E.removeAllRanges()}var F=document.createRange();F.selectNodeContents(A[0]);E.addRange(F)}catch(G){var F=document.body.createTextRange();F.moveToElementText(A[0]);F.select()}}}function r(){for(var E=D.length;E;E--){D[E-1].div.hide()}y("")}function q(K){function L(O,N){return !(O[0]>N[2]||O[2]<N[0]||O[1]<N[3]||O[3]>N[1])}function J(O,N){return(O[0]>=N[0]&&O[2]<=N[2])}var M="";K=[K.top,K.left+K.width+2,K.top+K.height+2,K.left];for(var G=0,E=D[0];G<D.length;E=D[++G]){if(!L(E.d,K)){E.div.hide();continue}if(J(E.d,K)){M+=E.s+"\n<br>";E.div.css(E.css)}else{var I=$.extend({},E.css),H=0,F=E.t.length-1;if(E.d[0]<K[0]){while(E.w[2*H+1]<K[3]){H++}}if(E.d[2]>K[2]){while(E.w[2*F]>K[1]){F--}}M+=E.t.slice(H,F+1).join(" ")+"\n<br>";I.left=E.w[2*H];I.width=E.w[2*F+1]-I.left;E.div.css(I)}E.div.show()}return M}})(DV&&DV.Page);var h=window.Lego={messages:{},block:{},params:{id:"mail","social-host":DV.socialHost}};h.block["i-social"]=function(s){function t(y){var x=this,v={};this.url=y.startUrl+"?";delete y.startUrl;this.popupName=y.popupName;this.yaWindow=null;this.wTimer=null;this.paramsDefault=y;function A(){var B;if(!x.yaWindow){return true}try{B=x.yaWindow.closed}catch(C){B=true}return B}function z(){if(A()){x.wTimer=clearInterval(x.wTimer);x.onFailure({status:"error"})}}function u(J){var M=x.popupName,E=500,N=280,G=Math.round((screen.availWidth-E)/2),K=Math.round((screen.availHeight-N)/2),C="scrollbars=yes, resizable=1, menubar=0, toolbar=0, status=0, location=0, directories=0, left="+G+", top="+K+", width="+E+", height="+N;var F={};for(var I in x.paramsDefault){F[I]=x.paramsDefault[I]}for(var I in J){F[I]=J[I]}var L=["ddom="+(F.ddom||(location.hostname==document.domain?"":document.domain))];F.retpath+=(F.retpath.match("#")?"&":"#")+L.join("&");var B=x.url;var D=[];for(var H in F){D.push(encodeURIComponent(H)+"="+encodeURIComponent(F[H]))}B+=D.join("&");x.yaWindow=window.open(B,M,C);x.yaWindow.focus();if(x.yaWindow){x.wTimer=setInterval(z,500)}}function w(){this.handlers={onSuccess:null,onFailure:null};x.wTimer=clearInterval(x.wTimer);A()||x.yaWindow.close();x.yaWindow=false}this.start=function(C,B,D){w();x.handlers={onSuccess:C,onFailure:B};u(D)};this.onSuccess=function(C){w();var B=x.handlers.onSuccess;B&&B()};this.onFailure=function(C){w();var B=x.handlers.onFailure;B&&B()}}arguments.callee.Broker=t;var r=arguments.callee.defaultParams={startUrl:h.params["social-startUrl"]||(h.params["social-host"]||"//social.yandex.ru")+"/broker/start",retpath:h.params["social-retpath"]||location.protocol+"//"+location.host+h.params["lego-path"]+"/blocks/i-social/closer/i-social__closer.html",consumer:h.params.id||"morda",popupName:"social_"+(h.params.id||"morda"),application:"",action_if_anonymous:"authorize",result_location:"fragment"};var q=arguments.callee.broker=new t($.extend(r,s));return q};!function(){var t=$(".js-edit");if(!t.length){return}t.click(function(){DV.Craw("edit in Office","click",DOC[2]);if(this.target){setTimeout(function(){DV.showPopup("edit-to-disk-success",function(x){x.find(".js-downloads-folder-link").attr({href:DV.diskHost+"/client/disk/Загрузки",target:"_blank"}).removeClass("js-downloads-folder").click(function(){DV.Cact("link_to_downloads","edit")})})},0)}else{var w=this.href;setTimeout(function(){location=w},300);return false}});DV.Craw("edit in Office","show",DOC[2]);var s=$(".js-edit-warning");if(!s.length){return}var r;function u(){if(r){clearTimeout(r);return}var w=t.offset();s.css({left:w.left+(t.width()-s.width())/2,top:w.top+t.height()+8}).show()}function v(){if(r){clearTimeout(r)}r=setTimeout(q,500)}function q(){r=null;s.hide()}if(s.length){t.on("mouseenter.warning",u).on("mouseleave.warning",v).one("click",function(){if(r){clearTimeout(r)}t.off(".warning");s.remove()});s.on("mouseenter",u).on("mouseleave",v)}}()});$(window).load(function(){document.getElementById("nojs").id="js";$(".b-page__loading").hide();DV.documentReady=true});function check_object(d){var c=document.getElementById(d);if(!c){return}var b=setInterval(a,50);a();function a(){if(c.offsetHeight){if(c.firstChild.offsetHeight){document.cookie="noiframe=1";location.reload()}clearTimeout(b)}}}(function(j,m,b){if(!m.DOC){DV.Count=function(){};DV.Cact=function(){};return}var g;if(DV.uid!="0"){g={uid:DV.uid,has_disk:DV.hasDisk?"1":"0"}}var h=[];var l=function(c){h.push(c)};DV.Count=function(){var c=[DOC[0]];c=c.concat(c.slice.call(arguments));l(c)};DV.Cact=function(){var c=[].concat(DOC[1],[].slice.call(arguments),DV.error?"no-file-page":"ok");l(c)};DV.Craw=function(){l([].slice.call(arguments))};if(DOC.length>3){DV.Count.apply(DV,DOC.slice(1));if((DV.page||1)===1){DV.Cact("view")}}function o(c){var f=c.pop();var d;while(d=c.pop()){var n={};n[d]=f;f=n}if(g){f.stat={stat:g}}return f}var k=15068284;var e;(m[b]=m[b]||[]).push(function(){try{e=new Ya.Metrika({id:k,enableAll:true});l=function(f){e.params(o(f))};var c;while(c=h.shift()){l(c)}}catch(d){}});var a=j.getElementsByTagName("script")[0],p=j.createElement("script"),i=function(){a.parentNode.insertBefore(p,a)};p.async=true;p.src="//mc.yandex.ru/metrika/watch.js";if(m.opera=="[object Opera]"){j.addEventListener("DOMContentLoaded",i)}else{i()}})(document,window,"yandex_metrika_callbacks");