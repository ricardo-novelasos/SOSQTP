webpackJsonp([16],{202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3191);n.n(o);Jane.module("promo.js",(function(){Daria.promo={},n(3192),n(3204),n(3205)}))},3191:function(e,t){},3192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(3193),n(961)},3193:function(e,t,n){"use strict";var o=n(3194),i=n(3195);Object(o.a)("hasInboxMessages",Daria.messages.everHadMessages),Jane.Promo={_queue:[],_promos:i.a,_nameOfShownPromo:"",availablePages:{messages:!1,message:!1},run:function(){this._queue=_.clone(this._promos),this._run()},_run:function(){var e=this,t=this.findPromo(Daria.urlParams.promo);if(t)return void this._invokeCallbackAndSetSettings(t);if(!this._isPromoSelected()&&!this._haveAllAvailablePagesBeenChecked())for(var n=!1;this._queue[0]&&!n;){var o=this._queue[0];this.shownSetting=o.name.slice(0,18)+"_s";var i=this._shouldInvokePromoCallback(o);if(!0===i)return void this._invokeCallbackAndSetSettings(o);if(i&&_.isFunction(i.then))return void i.then(function(t){return function(){n=!0,e._invokeCallbackAndSetSettings(t)}}(o),this._processNextPromo.bind(this));this._queue.shift()}},findPromo:function(e){return e?_.find(this._promos,{name:e})||null:null},showPromo:function(e){var t=this.findPromo(e);t&&this._invokeCallbackAndSetSettings(t)},_invokeCallbackAndSetSettings:function(e){this._nameOfShownPromo=e.name;try{e.callback(),this._setSettingsAfterSuccessRun(e)}catch(t){Jane.ErrorLog.sendException("promo-error."+e.name,t)}},_setSettingsAfterSuccessRun:function(e){var t=e.params,n=ns.Model.get("settings");t.showOnlyOnce&&n.setSettingOn(this.shownSetting),t.notAffectPromoDelay||n.updateSetting("promo-manager",{"last-time-show-promo":Daria.now(),"last-promo-was-name":e.name})},_processNextPromo:function(){this._queue.shift(),this._run()},_shouldInvokePromoCallback:function(e){var t=ns.Model.get("settings"),n=e.params,o=this._checkCommonPromoRules(e),i=n.ignoreStartPromoDelay||Daria.getAccountAgeInDays()>10,r=!t.getSetting(this.shownSetting),a=t.getSetting("promo-manager","json")||{},s=Number(a["last-time-show-promo"]||0),c=a["last-promo-was-name"]||"",u=Daria.now()-s>Jane.Date.WEEK;return(n.ignorePromoDelay||c===e.name)&&(u=!0),o&&u&&i&&r&&e.check()},_checkCommonPromoRules:function(e){var t=e.params;return(t.ignoreInboxMessages||Object(o.b)("hasInboxMessages"))&&(t.ignoreShowPromoSetting||!ns.Model.get("settings").getSetting("disable_promo"))&&(t.ignoreKCUFfilter||!Daria.IS_KCUF)&&(t.ignoreCORPfilter||!Daria.IS_CORP)&&this._isAvailablePage(ns.page.current.page)},_isPromoSelected:function(){return Boolean(this._nameOfShownPromo)},_isAvailablePage:function(e){var t=e in this.availablePages;return t&&(this.availablePages[e]=!0),t},_haveAllAvailablePagesBeenChecked:function(){var e=this;return Object.keys(this.availablePages).every((function(t){return e.availablePages[t]}))}}},3194:function(e,t,n){"use strict";function o(e){return r[e]="function"==typeof r[e]?r[e](window):r[e],r[e]}function i(e,t){void 0===r[e]&&(r[e]=t)}t.b=o,t.a=i;var r={}},3195:function(e,t,n){"use strict";t.a=_.map([n(3196),n(961),n(3197),n(962),n(3198),n(3199),n(3200),n(3201),n(3202)],"default")},3196:function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){i(this,e),this.name="attach-tab-promo",this.params={ignorePromoDelay:!0,ignoreStartPromoDelay:!0,ignoreInboxMessages:!0,ignoreKCUFfilter:!0,showOnlyOnce:!0},this.isShown=!1,this.hasSubscribed=!1,this._onPageAfterLoad=this._onPageAfterLoad.bind(this),this._onAttachOpen=this._onAttachOpen.bind(this),this._subscribeForSearch()}return a(e,[{key:"_isAttachTabIconOnPage",value:function(){return Boolean($(".js-attach-tab .svgicon").length)}},{key:"_getSettings",value:function(){return ns.Model.get("settings")}},{key:"_triggerPromoOnNextSession",value:function(){this.isShown=!0,this._getSettings().setSettings(o({},"AttachTabPromo-search-trigger","yes"))}},{key:"_onAttachOpen",value:function(){(Daria.isSearchPage()||Daria.isAttachmentsTab())&&this._triggerPromoOnNextSession()}},{key:"_onPageAfterLoad",value:function(){this._closeIfNoAnchor(),this._tryShowForSearchScenario()}},{key:"_closeIfNoAnchor",value:function(){this.promoPopup&&!this._isAttachTabIconOnPage()&&this.promoPopup.onSilentClose()}},{key:"_tryShowForSearchScenario",value:function(){if(Daria.isSearchPage()){var e=this._getSettings(),t="yes"===e.get(".".concat("AttachTabPromo-search-trigger")),n="yes"===e.get(".".concat("AttachTabPromo-search-isShown"));!t||n||this.isShown||(this.show(),this._unsubscribeFromSearch(),e.setSettings(o({},"AttachTabPromo-search-isShown","yes")))}}},{key:"_subscribeForSearch",value:function(){Daria.isAttachmentsTabEnabled()&&!this.hasSubscribed&&(this.hasSubscribed=!0,ns.events.on("ns-page-after-load",this._onPageAfterLoad),ns.events.on("daria:attachments:viewer@open",this._onAttachOpen))}},{key:"_unsubscribeFromSearch",value:function(){this.hasSubscribed&&(this.hasSubscribed=!1,ns.events.off("ns-page-after-load",this._onPageAfterLoad),ns.events.off("daria:attachments:viewer@open",this._onAttachOpen))}},{key:"check",value:function(){return Daria.isAttachmentsTabEnabled()&&!this.isShown&&this._isAttachTabIconOnPage()}},{key:"show",value:function(){this.isShown=!0,this.promoPopup=ns.View.create("attach-tab-promo"),this.promoPopup.show({where:".js-attach-tab .svgicon",how:{at:"left bottom",autoclose:!1,my:"left top",collision:"none"}})}},{key:"callback",value:function(){this.show()}}]),e})();t.default=new s},3197:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=l(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"PromoCloseOldThemesDisclaimer",(function(){return _}));var p=n(962),g="promo-close-themes-disclaimer",d="Предупреждение о закрытии",_=(function(e){function t(){var e;return i(this,t),e=s(this,h(t).call(this)),e.name=g,e.metricBlockName=d,e.params={ignorePromoDelay:!0,ignoreStartPromoDelay:!1,ignoreInboxMessages:!1,ignoreKCUFfilter:!1,showOnlyOnce:!1,ignoreShowPromoSetting:!1},e}return f(t,e),a(t,[{key:"getPromoText",value:function(){var e=Daria.getFeatureParams("web-close-old-themes-disclaimer"),t=e?new Date(e.closeDate):new Date,n=Jane.Date.format("%Date_dB",t),o=this.getOldThemeLocalName();return i18n("%Close_old_themes_warning",n,o)}},{key:"check",value:function(){return!u(h(t.prototype),"check",this).call(this)&&this.canShowPromo()&&Daria.hasFeature("web-close-old-themes-disclaimer")}},{key:"callback",value:function(){Daria.React.promoCloseOldThemesDisclaimer.create(),this.notifyShowMetric()}}]),t})(p.PromoCloseOldThemes);t.default=new _},3198:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"yandex-plus-tooltip",params:{showOnlyOnce:!0,ignoreInboxMessages:!0,ignoreKCUFfilter:!0,ignorePromoDelay:!0,ignoreStartPromoDelay:!0},check:function(){return Daria.canShowYandexPlusButton()&&!Daria.Config.haveYandexPlus},callback:function(){ns.events.trigger("daria:promo-manager:show-yandex-plus-tooltip")}}},3199:function(e,t,n){"use strict";function o(e,t){return a(e)||r(e,t)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(e,t){var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}function a(e){if(Array.isArray(e))return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}Object.defineProperty(t,"__esModule",{value:!0});var l={MIN_NEWSLETTERS_COUNT:10,MAX_SHOW_COUNT:1,DELAY_DAYS:NaN,promo:Daria.React.promoSubscriptions},h="promo-unsubscribe-popup",f=(function(){function e(){s(this,e),this.name=h,this.params={ignorePromoDelay:!0,ignoreStartPromoDelay:!0,ignoreInboxMessages:!1,ignoreKCUFfilter:!1,showOnlyOnce:!1,ignoreShowPromoSetting:!1},this.mSettings=null}return u(e,[{key:"check",value:function(){var e=this.getShownSetting(),t=Daria.promoNow()-e.lastTimeShown;return!(e.shownCount>=l.MAX_SHOW_COUNT||e.stopShow)&&(!(1===e.shownCount&&t<864e5*l.DELAY_DAYS)&&(!this.getSettingsModel().isSet("liza_minified_header")&&this.getNewsletters().then((function(e){return e.length>=l.MIN_NEWSLETTERS_COUNT?Vow.resolve():Vow.reject()}))))}},{key:"callback",value:function(){l.promo.create()}},{key:"getSettingsModel",value:function(){return this.mSettings||(this.mSettings=ns.Model.get("settings")),this.mSettings}},{key:"getNewsletters",value:function(){return ns.request("unsubscribe-furita-newsletters").then((function(e){return(o(e,1)[0].get(".newsletters")||[]).filter((function(e){return"13"===e.type}))})).fail((function(){return[]}))}},{key:"setStopShowSetting",value:function(){this.getSettingsModel().updateSetting(h,{stopShow:!0})}},{key:"setShownSettingDelay",value:function(){var e=this.getShownSetting().shownCount;this.getSettingsModel().updateSetting(h,{lastTimeShown:Daria.promoNow(),shownCount:e?++e:1})}},{key:"getShownSetting",value:function(){return this.getSettingsModel().getSetting(h,"json")||{}}},{key:"getCurrentMessage",value:function(){return 1===this.getShownSetting().shownCount?i18n("%Common.UnsubscribeSecondMessage"):i18n("%Common.UnsubscribeMessage")}},{key:"isAvailablePage",value:function(){return!0}}]),e})();t.default=new f},3200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i={DEFAULT:Jane.Date.WEEK,AFTER_FIRST_CLOSE:1.5*Jane.Date.MONTH,AFTER_SECOND_CLOSE:3*Jane.Date.MONTH},r=[i.DEFAULT,i.AFTER_FIRST_CLOSE,i.AFTER_SECOND_CLOSE],a={lastShowTime:0,delay:i.DEFAULT,forceNextShow:!1},s=Object.defineProperties({},{DO_NOT_SHOW_PROMO:{get:function(){var e=vow.reject();return e.catch(_.noop),e}},SHOW_PROMO:{get:function(){return vow.resolve()}}}),c=!1;t.default={name:"push-notifications",params:{ignorePromoDelay:!0,ignoreStartPromoDelay:!0,ignoreInboxMessages:!0},check:function(){if(c)return!1;c=!0;var e=ns.Model.get("settings"),t=Boolean(e.getSetting("browser_notify_message")),n=Daria.UA,o=n.BrowserName,i=n.BrowserVersion,r="YandexBrowser"===o&&i<18.6;return t||r?s.DO_NOT_SHOW_PROMO:this.isItNotTimeToShow()?s.DO_NOT_SHOW_PROMO:this.shouldShowPromo()},shouldShowPromo:function(){var e=ns.Model.get("settings"),t=!Daria.PushManager.compatible,n=e.hasSetting("browser_notify_message");if(t||n)return s.DO_NOT_SHOW_PROMO;if("denied"===Daria.PushManager.permission())return s.DO_NOT_SHOW_PROMO;if("granted"===Daria.PushManager.permission())return e.setSettingOn("browser_notify_message"),s.DO_NOT_SHOW_PROMO;var o=ns.Model.get("push-subscriptions",{clients:"bar,yabrowser"});if(o.isValid()){var i=this.extractSubscriptions(o);return this.checkSubscriptions(i).isFulfilled()?s.SHOW_PROMO:s.DO_NOT_SHOW_PROMO}return this.getSubscriptions().then(this.checkSubscriptions)},checkSubscriptions:function(e){var t="YandexBrowser"===Daria.UA.BrowserName&&e.yabrowser,n=Daria.hasYaBar&&e.bar;return t||n?s.DO_NOT_SHOW_PROMO:s.SHOW_PROMO},isItNotTimeToShow:function(){var e=ns.Model.get("settings");return o=_.assign(a,e.getSetting("push-notifications-promo","json")),o.forceNextShow?(e.updateSetting("push-notifications-promo",{forceNextShow:!1}),!1):!(Daria.promoNow()-o.lastShowTime>o.delay&&(e.updateSetting("push-notifications-promo",{forceNextShow:!0}),1))},getSubscriptions:function(){return ns.request("push-subscriptions",{clients:"bar,yabrowser"}).then(this.extractSubscriptions)},extractSubscriptions:function(e){var t="push-subscriptions"===e.id?e.data:e&&e[0]&&e[0].data;return _.reduce(t,(function(e,t){return e[t.client]=!0,e}),{})},callback:function(){var e=Daria.Dialog.open({width:550,body:Jane.tt("promo:promo-default",{icon:"mail-PushNotificationsPromo_Icon",title:i18n("%Promo_PushNotifications_Title"),description:i18n("%Promo_PushNotifications_Description")}),onTarget:{side:"right",needTail:!1},additionalClass:["mail-PushNotificationsPromo","js-push-notifications-promo"],paranjaFade:!1,dontCloseOnPageGo:!0,easyclose:!1,oncancel:function(){var e=(r.indexOf(o.delay)+1)%r.length,t=r[e];ns.Model.get("settings").updateSetting("push-notifications-promo",{forceNextShow:!1,delay:t}),Jane.c("Промо браузерных пушей","Клик в крестик")},onopen:function(){$(".js-push-notifications-promo").addClass("js-show-push-notifications-promo"),ns.Model.get("settings").updateSetting("push-notifications-promo",{lastShowTime:Daria.promoNow(),delay:i.DEFAULT}),Jane.c("Промо браузерных пушей","Показ")},buttons:[{promo:!0,customClass:"mail-PushNotificationsPromo_Button",title:i18n("%Promo_PushNotifications_ButtonTitle"),name:"enable-push-notifications",onclick:function(){ns.Model.get("settings").setSettingOn("browser_notify_message"),e.close(),Jane.c("Промо браузерных пушей",'Клик в "Включить уведомления"')}}]})}}},3201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"promo-nps",params:{ignoreInboxMessages:!0},check:function(){if(!Daria.hasExperiment("59509"))return!1;var e=ns.Model.get("settings").getSetting("promo-manager","json")||{};if(e["last-promo-was-name"]===this.name){var t=e["last-time-show-promo"]||0;return Daria.now()-t>7*Jane.Date.DAY}return!0},callback:function(){function e(e){e||ns.Model.get("settings").setSettingOn(t)}var t=Jane.Promo.shownSetting;Daria.React.promoNPS.create(e)}}},3202:function(e,t,n){"use strict";function o(){return r||(r=Jane.Services.runModules(["direct.js"]).then((function(){return Daria.yabsManager.init()}))),r}Object.defineProperty(t,"__esModule",{value:!0});var i,r,a=n(3203);t.default={name:"yabrowser-promoline",params:{ignorePromoDelay:!0,ignoreInboxMessages:!0,ignoreShowPromoSetting:!0,ignoreKCUFfilter:!0},check:function(){return"compose2"!==ns.page.current.page&&Daria.is2pane()&&["RUS","TUR"].indexOf(Daria.Config.product)>-1},callback:function(){o().then((function(){i=i||new a.a,i.show()}))}}},3203:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){var t=this;o(this,e),this.id="bk-stripe",this._pageLoadHandler=function(e,n){return t._onPageload(n)}}return r(e,[{key:"init",value:function(){this._inited=!0,this._initializeContainer(),this._loadAd()}},{key:"show",value:function(){this._inited||this.init(),this._repositionContainer(),this.node.show(),this._subscribeEvents(),this._sendMetrics("Показ")}},{key:"autohide",value:function(){this.node.hide(),this._unsubscribeEvents(),this._sendMetrics("Автоскрытие промо")}},{key:"_initializeContainer",value:function(){this.node=$('<div id="'.concat(this.id,'"/>')),this._repositionContainer()}},{key:"_loadAd",value:function(){Daria.yabs.showStripe(this.id,"Y-A-288968-1")}},{key:"_repositionContainer",value:function(){this.node.prependTo(".js-mail-App")}},{key:"_subscribeEvents",value:function(){ns.events.on("ns-page-before-load",this._pageLoadHandler)}},{key:"_unsubscribeEvents",value:function(){ns.events.off("ns-page-before-load",this._pageLoadHandler)}},{key:"_onPageload",value:function(e){"compose2"===e[1].page&&this.autohide()}},{key:"_sendMetrics",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Jane.c(["Промо-полоска БК"].concat(t))}}]),e})()},3204:function(e,t){ns.layout.define("promo-disk-tab-popup",{"promo-disk-tab":{}}),ns.layout.define("attach-tab-promo-popup",{"attach-tab-promo":{}})},3205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3206),i=(n.n(o),n(3207));n.n(i)},3206:function(e,t){!(function(){var e=["Промо диска"];ns.View.define("promo-disk-tab",{events:{"click .js-disk-tab-popup-close":"onCloseClick","click .js-disk-tab-promo-button":"onButtonClick","resize window":"close"},yateModule:"promo",ctor:function(){this.onClosed=this._onClosed.bind(this)},methods:{_metrika:function(){Jane.c(e.concat(Array.prototype.slice.call(arguments)))},show:function(e){var t=this;this._render().then((function(){return t._open(e)}))},close:function(){this.nbPopup&&this.nbPopup.close()},onButtonClick:function(){this._metrika("Клик на кнопку"),this.close()},onCloseClick:function(e){return this.close(),this._metrika("Закрытие крестом"),e.preventDefault(),!1},_render:function(){return new ns.Update(this,ns.layout.page("promo-disk-tab-popup",{}),{},{execFlag:ns.U.EXEC.PARALLEL}).render()},_open:function(e){var t=_.extend({class:"mail-DiskTabPromo-Container",autofocus:!1},e);this.nbPopup=nb.block(this.node),this._bindCustomEvents(),this._metrika("Показ промо"),this.nbPopup.open(t)},_bindCustomEvents:function(){this.nbPopup.on("nb-closed",this.onClosed)},_unbindCustomEvents:function(){this.nbPopup.off("nb-closed",this.onClosed)},_onClosed:function(){var e=this;this._unbindCustomEvents(),_.defer((function(){e.nbPopup&&e.nbPopup.destroy(),e.nbPopup=null,e.destroy()}))}}})})()},3207:function(e,t){!(function(){var e=['Промо таба "С вложениями"'];ns.View.define("attach-tab-promo",{events:{"ns-page-after-load@show":"onCloseOnOpenAttachTab","click .js-attach-tab-promo-popup-close":"onCloseClick"},yateModule:"promo",ctor:function(){this.onClosed=this._onClosed.bind(this)},methods:{_metrika:function(){Jane.c([].concat(e,Array.prototype.slice.call(arguments)))},show:function(e){var t=this;this._render().then((function(){return t._open(e)}))},_close:function(){this.nbPopup&&this.nbPopup.close()},onSilentClose:function(){this._close()},onCloseOnOpenAttachTab:function(){Daria.isAttachmentsTab()&&(this._close(),this._metrika("Клик в таб"))},onCloseClick:function(e){return this._close(),this._metrika("Клик в крестик"),e.preventDefault(),!1},_render:function(){return new ns.Update(this,ns.layout.page("attach-tab-promo-popup",{}),{},{execFlag:ns.U.EXEC.PARALLEL}).render()},_open:function(e){var t=_.extend({class:"mail-AttachTabPromo-Container",autofocus:!1},e);this.nbPopup=nb.block(this.node),this._metrika("Показ"),this.nbPopup.open(t)},_onClosed:function(){var e=this;_.defer((function(){e.nbPopup&&e.nbPopup.destroy(),e.nbPopup=null,e.destroy()}))}}})})()},961:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.default={name:"disk-tab-promo",params:{ignorePromoDelay:!0,ignoreStartPromoDelay:!0,ignoreInboxMessages:!0,ignoreKCUFfilter:!0,showOnlyOnce:!0},check:function(){return!(Daria.Config.workspace||"messages"!==ns.page.current.page||!Daria.hasFeature("web_promo_disk")||"ru"!==Daria.Config.locale)&&(o=o&&o.length?o:$(".mail-ui-Link-Disk>span"),o.length&&o.is(":visible"))},callback:function(){ns.View.create("promo-disk-tab").show({where:".mail-ui-Link-Disk>span",how:{at:"center bottom",my:"center top",collision:"none"}})}}},962:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"PromoCloseOldThemes",(function(){return c}));var a="promo-close-old-themes",s="Уведомление о закрытии",c=(function(){function e(){o(this,e),this.name=a,this.metricBlockName=s,this.params={ignorePromoDelay:!0,ignoreStartPromoDelay:!1,ignoreInboxMessages:!1,ignoreKCUFfilter:!1,showOnlyOnce:!1,ignoreShowPromoSetting:!1,ignoreCORPfilter:!0},this.oldThemesId={anime:i18n("%Theme_name_anime"),art:i18n("%Theme_name_art"),capitals:i18n("%Theme_name_capitals"),cat:i18n("%Theme_name_cat"),dreams:i18n("%Theme_name_dreams"),"ice-cream":i18n("%Theme_name_ice-cream"),kindergarten:i18n("%Theme_name_kindergarten"),kitekat:i18n("%Theme_name_kitekat"),newyear2010:i18n("%Theme_name_newyear2011"),origami:i18n("%Theme_name_origami"),pushkin:i18n("%Theme_name_pushkin"),"red-list":i18n("%Theme_name_red-list")}}return r(e,[{key:"notifyShowMetric",value:function(){Jane.c("Закрытие тем",this.metricBlockName,"показ")}},{key:"notifyCloseMetric",value:function(){Jane.c("Закрытие тем",this.metricBlockName,"закрытие по крестику")}},{key:"off",value:function(){this.notifyCloseMetric();var e=ns.Model.get("settings");e.updateSetting(this.name,{promoClosed:!0}),e.setSettings({"theme-migrated-from":""})}},{key:"_getPromoSetting",value:function(){return ns.Model.get("settings").getSetting(this.name,"json")||{}}},{key:"getOldThemeLocalName",value:function(){var e=this._getOldTheme();return e&&this.oldThemesId[e]}},{key:"_getOldTheme",value:function(){return ns.Model.get("settings").getSetting("theme-migrated-from")}},{key:"getPromoText",value:function(){var e=this.getOldThemeLocalName();return i18n("%Closed_old_themes_notify",e)}},{key:"canShowPromo",value:function(){return this._getOldTheme()&&!this._getPromoSetting().promoClosed}},{key:"check",value:function(){return Daria.hasExperiment("89903")&&this.canShowPromo()}},{key:"callback",value:function(){Daria.React.promoCloseOldThemes.create(),this.notifyShowMetric()}}]),e})();t.default=new c}});